import asyncio

import pytest
from sqlalchemy.exc import OperationalError
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import text
from db import get_session  # Импортируйте функцию get_session из вашего модуля


async def main():
    async for session in get_session():
        async with session.begin():
            result = await session.execute(text("CREATE TABLE IF NOT EXISTS items (id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,name TEXT NOT NULL)"))
            await session.commit()


asyncio.run(main())



"""CREATE TABLE IF NOT EXISTS users
(id serial,
username text NOT NULL,
password text NOT NULL
);"""

"""CREATE TABLE IF NOT EXISTS Todo
(id serial,
title text NOT NULL,
description text NOT NULL,
completed bool DEFAULT False
);"""

"""ALTER TABLE users ADD PRIMARY KEY (id)"""
"""ALTER TABLE todo ADD COLUMN user_id INTEGER REFERENCES users(id) ON DELETE CASCADE;"""
"""ALTER TABLE todo
ADD COLUMN created_at TIMESTAMP NOT NULL DEFAULT NOW()"""

"""ALTER TABLE todo
ADD COLUMN competed_at TIMESTAMP DEFAULT NULL"""